{{define "ROOT"}}
package api

// THIS FILE GENERATED USING METIS
// TO REGENERATE BASED ON NEW DEFINITIONS
// cd gen/ && go run gen.go

func router(db data.DB, sockets autonomous.Manager) serve.Router {
    r := builtin.NewRouter()
    {{range $key, $model := .Models}}
        r.GET("/{{$model.Space}}", Serve(hermes.GET, "{{$model.Kind}}", db))
        r.POST("/{{$model.Space}}", Serve(hermes.POST, "{{$model.Kind}}", db))
        r.DELETE("/{{$model.Space}}", Serve(hermes.DELETE, "{{$model.Kind}}", db))
    {{end}}

    r.GET("/hermes", HermesSocket(sockets))
    return r
}
{{end}}
